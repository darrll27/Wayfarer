# Centralized broker config is in config/broker.json. Keep this file focused on transports/groups/forwards.
verbose: true
# internal GCS sysid/compid
gcs_sysid: 250
gcs_compid: 190

# transports: define UDP/Serial ports to start. UDP host should be 0.0.0.0 to listen.
transports:
  - type: udp
    name: udp_QGC
    host: 127.0.0.1
    port: 14551
  - type: serial
    name: serial_cu_usbmodem01
    device: /dev/cu.usbmodem01
    baud: 115200

# groups: define fleets and their drone endpoints (drone id -> udp endpoint)
groups:
  alpha:
    launch_delay_s: 5
    # drones now reference named endpoints defined in the `endpoints` section below
    drones:
      1: drone_alpha_1
      2: drone_alpha_2

# endpoints: canonical mapping of logical endpoint names to URIs
# Use these names in `groups.<group>.drones` instead of raw URIs to avoid duplication.
endpoints:
  drone_alpha_1: udp://127.0.0.1:14560
  drone_alpha_2: udp://127.0.0.1:14561

# forwarding rules: forward everything based on PORTS (port-centric)
# For observability we enqueue into transports (to_port) so the router + mqtt
# adapters can observe forwarded traffic as if it came from that port.
forwards:
  - from: serial_cu_usbmodem01
    dedupe_window: 0.5
    to:
      - type: to_port
        port_name: drone_alpha_1
      - type: to_port
        port_name: udp_QGC